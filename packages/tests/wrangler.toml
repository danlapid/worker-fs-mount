# Wrangler configuration for test worker
name = "worker-fs-mount-tests"
main = "index.ts"
compatibility_date = "2025-12-17"
compatibility_flags = ["nodejs_compat"]

# Alias node:fs/promises and node:fs to our mount-aware implementations
[alias]
"node:fs/promises" = "worker-fs-mount/fs"
"node:fs" = "worker-fs-mount/fs-sync"

# SQLite migration for Durable Objects (accessed via ctx.exports)
# DurableObjectFilesystem - for async tests (/do/*)
# TestDurableObjectFilesystem - for sync tests (/local-do/*, /async-sync/*)
[[migrations]]
tag = "v1"
new_sqlite_classes = ["DurableObjectFilesystem", "TestDurableObjectFilesystem"]

# R2 bucket for R2Filesystem tests
[[r2_buckets]]
binding = "TEST_BUCKET"
bucket_name = "test-bucket"
